(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17604,        366]
NotebookOptionsPosition[     17296,        352]
NotebookOutlinePosition[     17641,        367]
CellTagsIndexPosition[     17598,        364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<summative`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Include", " ", "files", " ", "defining", " ", "helper", " ", 
    RowBox[{"functions", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", " ", "\"\<SummativeLibrary.wl\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"<<", " ", "\"\<DisplayLibrary.wl\>\""}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "States", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EMPTY", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SPECIES1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SPECIES2", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", "25"}], ";"}], 
  RowBox[{"(*", " ", "Radius", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "=", 
    RowBox[{"r", "+", "1"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Coordinate", " ", "of", " ", "the", " ", "centre", " ", "cell"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{
     RowBox[{"2", "r"}], "+", "1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", "Width", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sr", "=", "4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Seeding", " ", "radius"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gens", "=", "25"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "generations"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Number", " ", "of", " ", 
     RowBox[{"seeds", ".", " ", "In"}], " ", "the", " ", "paper"}], ",", " ", 
    
    RowBox[{"this", " ", "is", " ", "parameter", " ", 
     RowBox[{"q", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ns1", "=", "37"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ns2", "=", "40"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Initialize", " ", "the", " ", "space"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"EMPTY", ",", 
     RowBox[{"{", 
      RowBox[{"w", ",", "w"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", 
    RowBox[{"mRandomStart", "[", 
     RowBox[{"r", ",", "20", ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Matrix", " ", "that", " ", "contains", " ", "the", " ", "probability", 
    " ", "of", " ", "receiving", " ", "a", " ", "seed", " ", "from", " ", 
    RowBox[{"neighbours", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dispersal", "=", 
   RowBox[{"mEffectMatrix", "[", "sr", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"dispersal", "=", 
    RowBox[{"dispersal", "/", 
     RowBox[{"Total", "[", 
      RowBox[{"dispersal", ",", "2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "takes", " ", "the", " ", "state", " ", "of",
     " ", "the", " ", "system", " ", "and", " ", "computes", " ", "the", " ", 
    "next", " ", 
    RowBox[{"state", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mNextState", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "matrix", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Number", " ", "of", " ", "seeds", " ", "of", " ", "each", " ", 
        "species", " ", "received", " ", "by", " ", "each", " ", 
        RowBox[{"patch", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "The", " ", "ListConvolve", " ", "function", " ", "took", " ", "me", 
         " ", "a", " ", "few", " ", "days", " ", "to", " ", "understand", " ",
          "completely"}], ",", " ", 
        RowBox[{"but", " ", 
         RowBox[{"it", "'"}], "s", " ", "quite", " ", 
         RowBox[{"fast", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"seeding1", "=", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{"dispersal", ",", "matrix", ",", 
          RowBox[{"sr", "+", "1"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#2", "\[Equal]", "1"}], ",", 
             RowBox[{"mRandomBinomial", "[", 
              RowBox[{"ns1", ",", "#1"}], "]"}], ",", "0"}], "]"}], "&"}], 
          ",", "Plus"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"seeding2", "=", 
        RowBox[{"ListConvolve", "[", 
         RowBox[{"dispersal", ",", "matrix", ",", 
          RowBox[{"sr", "+", "1"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#2", "\[Equal]", "2"}], ",", 
             RowBox[{"mRandomBinomial", "[", 
              RowBox[{"ns2", ",", "#1"}], "]"}], ",", "0"}], "]"}], "&"}], 
          ",", "Plus"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Loop", " ", "through", " ", "each", " ", "cell"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{"mNextCell", ",", 
         RowBox[{"{", 
          RowBox[{"matrix", ",", "seeding1", ",", "seeding2"}], "}"}], ",", 
         "2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "takes", " ", "the", " ", "state", " ", "of",
     " ", "a", " ", "cell", " ", "and", " ", "computes", " ", "the", " ", 
    "next", " ", 
    RowBox[{"state", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"cell", " ", "is", " ", "the", " ", "current", " ", "state"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "s1", " ", "is", " ", "the", " ", "number", " ", "of", " ", "seeds", " ", 
    "from", " ", "species", " ", "1", " ", "on", " ", "that", " ", "patch"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "s2", " ", "is", " ", "the", " ", "number", " ", "of", " ", "seeds", " ", 
    "from", " ", "species", " ", "2"}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"mNextCell", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cell", ",", "s1", ",", "s2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s1", ">", "s2"}], ",", "1", ",", "\[IndentingNewLine]", 
        RowBox[{"s1", "<", "s2"}], ",", "2", ",", "\[IndentingNewLine]", 
        "True", ",", "0"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Run", " ", "and", " ", "display", " ", "the", " ", "results"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", "0"}], ";", 
  RowBox[{"ProgressIndicator", "[", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"x", "/", "gens"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"NestList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "++"}], ";", 
        RowBox[{"mNextState", "[", "#", "]"}]}], ")"}], "&"}], ",", "m", ",", 
     "gens"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mPlotPlants", "[", "results", "]"}]}], "Input",
 CellChangeTimes->{{3.6999616165015793`*^9, 3.699961668230633*^9}, {
   3.699962236469988*^9, 3.699962262346182*^9}, {3.699962915512845*^9, 
   3.699962932982798*^9}, {3.6999630418220987`*^9, 3.699963092250412*^9}, {
   3.699963272701288*^9, 3.699963320249563*^9}, {3.699974129493504*^9, 
   3.69997416557327*^9}, {3.699976518102976*^9, 3.699976576598646*^9}, 
   3.699976647165749*^9, {3.6999767372044067`*^9, 3.699976828953079*^9}, {
   3.699976887977929*^9, 3.6999769461491823`*^9}, {3.699976976157885*^9, 
   3.699977013138886*^9}, {3.699977374605027*^9, 3.699977400085846*^9}, {
   3.699978059377494*^9, 3.699978112346755*^9}, {3.69997844845039*^9, 
   3.69997846285639*^9}, {3.699978759999961*^9, 3.699978798042803*^9}, {
   3.699978908803679*^9, 3.699978909007444*^9}, {3.699980003549377*^9, 
   3.699980007300219*^9}, {3.699980127834676*^9, 3.699980129655109*^9}, {
   3.699980463615522*^9, 3.6999804664215317`*^9}, {3.6999805219330063`*^9, 
   3.6999805607294073`*^9}, {3.69998062201383*^9, 3.699980706221726*^9}, {
   3.699980741391651*^9, 3.699980803707925*^9}, {3.699981178532119*^9, 
   3.699981212511023*^9}, {3.699981260368155*^9, 3.6999812794841967`*^9}, {
   3.699981313974785*^9, 3.699981342836164*^9}, {3.699981426935397*^9, 
   3.6999814329001503`*^9}, {3.6999817555642357`*^9, 3.699981778152907*^9}, {
   3.6999818161655817`*^9, 3.699981868810638*^9}, {3.699982016103655*^9, 
   3.69998203364191*^9}, {3.699982065259596*^9, 3.699982107193149*^9}, {
   3.700135945072198*^9, 3.700135972889266*^9}, {3.700136021067786*^9, 
   3.700136021978373*^9}, {3.7001362505792513`*^9, 3.700136362583213*^9}, 
   3.7001364260245943`*^9, {3.700147562412978*^9, 3.700147579837641*^9}, {
   3.700147617081444*^9, 3.700147625545248*^9}, {3.7001476638258133`*^9, 
   3.700147799241013*^9}, {3.700147937724506*^9, 3.7001480591517973`*^9}, {
   3.700148099128213*^9, 3.7001482261857986`*^9}, {3.7001482608848867`*^9, 
   3.700148292408161*^9}, {3.700148331222958*^9, 3.7001483321277742`*^9}, {
   3.700148524137579*^9, 3.700148548965549*^9}, {3.700148593579701*^9, 
   3.7001487006193943`*^9}, 3.700148737942561*^9, {3.700148799779792*^9, 
   3.7001488272107887`*^9}, {3.7001488701622066`*^9, 
   3.7001489077145853`*^9}, {3.7001489488053627`*^9, 3.700148949172262*^9}, {
   3.70014953287269*^9, 3.700149624407324*^9}, {3.700149661602694*^9, 
   3.700149784955192*^9}, {3.7001498182762136`*^9, 3.7001498415355997`*^9}, {
   3.7001498921446323`*^9, 3.700149892254569*^9}, {3.7001499877545633`*^9, 
   3.700149989663534*^9}, {3.700150106850315*^9, 3.700150141449044*^9}, {
   3.700150175278413*^9, 3.7001501916553497`*^9}, {3.700150225997073*^9, 
   3.700150226282065*^9}, {3.700150264578404*^9, 3.700150345767887*^9}, {
   3.7001503831489067`*^9, 3.7001503863245*^9}, {3.700150424684485*^9, 
   3.700150424764399*^9}, {3.7001504613055553`*^9, 3.700150463647484*^9}, {
   3.700150519567217*^9, 3.700150559520808*^9}, {3.7001519085870457`*^9, 
   3.7001520627088118`*^9}, {3.700152109246146*^9, 3.700152156810481*^9}, {
   3.700152190037279*^9, 3.7001521959956837`*^9}, {3.700152231820496*^9, 
   3.700152234922278*^9}, 3.7001523052150803`*^9, {3.700152382487537*^9, 
   3.7001523956300163`*^9}, {3.70015256636937*^9, 3.7001527097078876`*^9}, {
   3.700152814550866*^9, 3.700152829486043*^9}, {3.700153142015712*^9, 
   3.700153243730142*^9}, {3.700153338936324*^9, 3.7001533596057463`*^9}, {
   3.7001534503346367`*^9, 3.7001534651632633`*^9}, {3.700153505483349*^9, 
   3.700153533594377*^9}, {3.7002164296720877`*^9, 3.700216610650551*^9}, {
   3.700216643729457*^9, 3.7002166467034616`*^9}, {3.700216685633256*^9, 
   3.700216685766778*^9}, {3.700216728198557*^9, 3.7002167774219913`*^9}, 
   3.700217056374979*^9, {3.7003833049061613`*^9, 3.700383589954485*^9}, {
   3.700383630090815*^9, 3.700383638033661*^9}, 3.7003837068019333`*^9, {
   3.700383738317047*^9, 3.700383754738139*^9}, {3.700383793300597*^9, 
   3.700383828820896*^9}, {3.7003838669150257`*^9, 3.700383873900652*^9}, {
   3.700383910611641*^9, 3.700383961585855*^9}, {3.700384015863771*^9, 
   3.700384051267641*^9}, {3.700384087860066*^9, 3.700384099474639*^9}, {
   3.700384137221623*^9, 3.700384175654303*^9}, {3.700384224967922*^9, 
   3.700384338006073*^9}, {3.700384378321783*^9, 3.7003844546138067`*^9}, {
   3.700385334144009*^9, 3.700385334232856*^9}, {3.700385396955172*^9, 
   3.7003853977635937`*^9}, {3.70038543136353*^9, 3.700385519145936*^9}, {
   3.7003855497562113`*^9, 3.700385578128645*^9}, {3.700385613063531*^9, 
   3.700385613169259*^9}, {3.7003856673924637`*^9, 3.70038568461434*^9}, {
   3.700385731963236*^9, 3.70038573724864*^9}, {3.700386012387189*^9, 
   3.700386198454516*^9}, {3.700386243089684*^9, 3.700386243170575*^9}, {
   3.700386276710636*^9, 3.700386292771387*^9}, {3.7003863919870167`*^9, 
   3.7003863974149027`*^9}, {3.700386519518381*^9, 3.700386519683798*^9}, 
   3.700386765729504*^9, 3.700386921599226*^9, {3.700514745710932*^9, 
   3.700514768093161*^9}, {3.70051550985244*^9, 3.700515512624834*^9}, {
   3.700515859084269*^9, 3.7005158599321947`*^9}, {3.7005164269748173`*^9, 
   3.7005164300117207`*^9}, {3.700516465692638*^9, 3.70051646575493*^9}, {
   3.7005169885769453`*^9, 3.7005169886704693`*^9}, {3.7005173565923777`*^9, 
   3.700517367901807*^9}, {3.702050839271796*^9, 3.7020508956641197`*^9}, 
   3.702051001134055*^9, {3.702051321741632*^9, 3.7020514451834784`*^9}, {
   3.702052720092422*^9, 3.702052755018005*^9}, {3.702052823824677*^9, 
   3.7020528361789427`*^9}, {3.702052884262405*^9, 3.702052933408395*^9}, {
   3.702053037080534*^9, 3.70205334799562*^9}, {3.70205338668686*^9, 
   3.702053506419674*^9}, {3.702053544458044*^9, 3.702053551479697*^9}, {
   3.702053633974015*^9, 3.702053704012107*^9}, {3.702053775289596*^9, 
   3.702053781033369*^9}, {3.702054134462812*^9, 3.702054167583049*^9}, {
   3.702054268649984*^9, 3.702054270573804*^9}, {3.7020543013964853`*^9, 
   3.702054305665614*^9}, {3.702054583427147*^9, 3.702054595248645*^9}, {
   3.702054632368992*^9, 3.702054645396696*^9}, {3.702054708428832*^9, 
   3.702054735768263*^9}, {3.702054772581738*^9, 3.702054772688142*^9}, {
   3.702054874026182*^9, 3.702054878079463*^9}, {3.702054927326673*^9, 
   3.702055159453518*^9}, {3.7020552147042723`*^9, 3.702055242867057*^9}, {
   3.702055436148044*^9, 3.702055456648382*^9}, {3.702055487695978*^9, 
   3.7020555748812647`*^9}, {3.702055627912122*^9, 3.702055638965271*^9}, {
   3.702056317811409*^9, 3.702056380758995*^9}, {3.702056448535884*^9, 
   3.702056498625764*^9}, {3.702056564372558*^9, 3.702056580791707*^9}, {
   3.70205707093862*^9, 3.70205715033559*^9}, 3.702057180493105*^9, {
   3.702057241787181*^9, 3.702057245918777*^9}, {3.702057375621189*^9, 
   3.702057384625552*^9}, 3.702057438003707*^9, {3.702057470061899*^9, 
   3.702057470180004*^9}, {3.702057507790188*^9, 3.702057509659335*^9}, {
   3.702057575719378*^9, 3.702057655253573*^9}, {3.7020577726437473`*^9, 
   3.7020577837976227`*^9}, {3.70205782980567*^9, 3.7020578304310293`*^9}, {
   3.702064044291387*^9, 3.702064056503323*^9}, {3.702149244857174*^9, 
   3.7021492480472603`*^9}, {3.702150339727764*^9, 3.7021503433021183`*^9}, {
   3.702231502019926*^9, 3.702231519804186*^9}, {3.702231653118306*^9, 
   3.70223165328578*^9}, {3.702231891257126*^9, 3.7022318955344667`*^9}, {
   3.702232677819248*^9, 3.702232733657793*^9}, {3.702232850367474*^9, 
   3.7022328504125175`*^9}, {3.702290171075835*^9, 3.702290189891488*^9}, {
   3.702290235479209*^9, 3.7022902627073092`*^9}, {3.7022903021731634`*^9, 
   3.7022904095316305`*^9}, {3.7022904414216967`*^9, 
   3.7022904697966127`*^9}, {3.702290680049097*^9, 3.7022907331546307`*^9}, {
   3.7022950127364254`*^9, 3.7022950127764635`*^9}, {3.702299937131935*^9, 
   3.7022999572572703`*^9}, {3.7022999872800856`*^9, 
   3.7023000571183004`*^9}, {3.7023001531386805`*^9, 
   3.7023002908822165`*^9}, {3.702313744949997*^9, 3.7023138546334667`*^9}, {
   3.7023171474944077`*^9, 3.702317157120202*^9}, {3.7023175052602606`*^9, 
   3.702317505275901*^9}, {3.702317536291953*^9, 3.7023175409656096`*^9}, {
   3.7023180641214623`*^9, 3.702318065219735*^9}, {3.7023189922063875`*^9, 
   3.702318997900029*^9}, {3.7023221198781133`*^9, 3.7023221199231453`*^9}, {
   3.70232799680727*^9, 3.702328071807166*^9}, {3.702328155239197*^9, 
   3.702328224126901*^9}, {3.7023283278863707`*^9, 3.7023283412471666`*^9}, {
   3.7023283855426416`*^9, 3.7023284370401983`*^9}, {3.702393192357552*^9, 
   3.702393208382654*^9}},ExpressionUUID->"2d680509-1ff1-44bd-abf9-\
4028156af6ca"]
},
WindowSize->{808, 751},
WindowMargins->{{Automatic, 236}, {109, Automatic}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16734, 330, 1190, "Input", "ExpressionUUID" -> \
"2d680509-1ff1-44bd-abf9-4028156af6ca"]
}
]
*)

